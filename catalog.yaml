metadata:
  version: 1
sources:
  icesat2atl06:
    args:
      chunks:
        delta_time: 50000
      path_as_pattern: ATL06_{datetime:%Y%m%d%H%M%S}_{referencegroundtrack:4}{cyclenumber:2}{orbitalsegment:2}_{version:3}_{revision:2}.h5
      # urlpath: https://n5eil02u.ecs.nsidc.org/opendap/hyrax/ATLAS/ATL06.002/{{date.strftime("%Y.%m.%d")}}/ATL06_*_*{{orbitalsegment}}_002_01.h5
      urlpath: https://n5eil01u.ecs.nsidc.org/ATLAS/ATL06.002/{{date.strftime("%Y.%m.%d")}}/ATL06_*_*{{orbitalsegment}}_002_01.h5
      xarray_kwargs:
        combine: nested
        concat_dim: referencegroundtrack  # from 0000 to 1387
        engine: h5netcdf
        group: /{{laser}}/land_ice_segments
        parallel: true
    # https://intake.readthedocs.io/en/latest/catalog.html#parameter-definition
    parameters:
        date:
          description: Year, month, and day of data acquisition
          type: datetime
          default: 2019.06.26
          min: 2018.10.14
          max: 2019.11.15  # note gap from 2019.06.27 to 2019.07.25 (inclusive)
        orbitalsegment:
          description: Orbital Segment
          type: str
          default: 11
          allowed: [10, 11, 12]
        laser:
          description: Name of laser
          type: str
          default: gt2l
          allowed: ["gt1l", "gt1r", "gt2l", "gt2r", "gt3l", "gt3r"]
    description: ''
    driver: intake_xarray.netcdf.NetCDFSource
    cache:
      - argkey: urlpath
        regex: 'n5eil01u.ecs.nsidc.org'
        type: file
    metadata:
      plots:
        quickview:
          kind: points
          x: longitude
          y: latitude
          datashade: True
          width: 800
          height: 500
